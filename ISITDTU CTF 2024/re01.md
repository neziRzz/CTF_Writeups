# Misc
- Đề cho 1 file PE64

![image](https://github.com/user-attachments/assets/0f119e9b-3020-403c-9212-a3e79efeb978)

# Detailed Analysis
- IDA's Pseudocode (Vì mã giả khá dài nên mình xin phép rút gọn lại những hàm và những luồng không quá quan trọng)
- Hàm `main`
```C
int __fastcall main(int argc, const char **argv, const char **envp)
{
  *(_OWORD *)v12 = 0i64;
  v13 = 0i64;
  v14 = 15i64;
  LOBYTE(v12[0]) = 0;
  sub_1400015F0(std::cin, v12, envp);
  *(_OWORD *)Block = 0i64;
  v20 = 0i64;
  v21 = 15i64;
  LOBYTE(Block[0]) = 0;
  v18[0] = 0x67452301;
  v18[1] = 0xEFCDAB89;
  v18[2] = 0x98BADCFE;
  v18[3] = 0x10325476;
  v18[4] = 0xC3D2E1F0;
. . . . . .
init_sha1((__int64)v18, (__int64)v23)
  *(__int64 *)((char *)v23 + *(int *)(v23[0] + 4)) = (__int64)&std::istringstream::`vftable';
  *(_DWORD *)((char *)&v22 + *(int *)(v23[0] + 4) + 4) = *(_DWORD *)(v23[0] + 4) - 144;
  sub_7FF7D14E2430((__int64)&v23[2]);
  std::istream::~istream<char,std::char_traits<char>>(&v23[3]);
  std::ios::~ios<char,std::char_traits<char>>(&v23[18]);
  sub_7FF7D14E6250(v18, Buf1);
  v4 = Buf1;
  v5 = (char *)Buf1[0];
  v6 = v17;
  if ( v17 > 0xF )
    v4 = (void **)Buf1[0];
  if ( Size == 40 && !memcmp(v4, "eeeddf4ae0c3364f189a37f79c9d7223a1d60ac7", 0x28ui64) )
  {
    v7 = sub_7FF7D14E17D0(std::cout);
    std::ostream::operator<<(v7, sub_7FF7D14E1990);
    v6 = v17;
    v5 = (char *)Buf1[0];
  }
. . . . . . . .
  return 0;
```
- Hàm `main` sẽ có nhiệm vụ lấy input của player, khởi tạo cho `v18` là các hằng số được sử dụng trong thuật toán hashing `SHA-1`, sau khi khởi tạo các buffer cần thiết, hàm `init_sha1` sẽ có nhiệm vụ khởi tạo state và thực hiện hash input của player bằng thuật toán `SHA-1` 
# Script and Flag
```python
cyphertext =[
  0x7C, 0x00, 0x00, 0x00, 0x66, 0x00, 0x00, 
  0x00, 0x7C, 0x00, 0x00, 0x00, 0x61, 0x00, 0x00, 0x00, 0x71, 
  0x00, 0x00, 0x00, 0x61, 0x00, 0x00, 0x00, 0x60, 0x00, 0x00, 
  0x00, 0x4E, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x5A, 
  0x00, 0x00, 0x00, 0x5B, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 
  0x00, 0x47, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x41, 
  0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x6A, 0x00, 0x00, 
  0x00, 0x6C, 0x00, 0x00, 0x00, 0x5A, 0x00, 0x00, 0x00, 0x40, 
  0x00, 0x00, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x66, 0x00, 0x00, 
  0x00, 0x5A, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x43, 
  0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 
  0x00, 0x6A, 0x00, 0x00, 0x00, 0x61, 0x00, 0x00, 0x00, 0x79, 
  0x00, 0x00, 0x00, 0x66, 0x00, 0x00, 0x00, 0x6A, 0x00, 0x00, 
  0x00, 0x76, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x59, 
  0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 
  0x00, 0x54, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x5E, 
  0x00, 0x00, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x67, 0x00, 0x00, 
  0x00, 0x50, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x04, 
  0x00, 0x00, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x7D, 0x00, 0x00, 
  0x00, 0x54, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x50, 
  0x00, 0x00, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x73, 0x00, 0x00, 
  0x00, 0x40, 0x00, 0x00, 0x00, 0x5B, 0x00, 0x00, 0x00, 0x6A, 
  0x00, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0x1C, 0x00, 0x00, 
  0x00, 0x48, 0x00
]
for i in cyphertext:
    if(i!=0):
        print(chr(i ^ 0x35),end='')
```
**Flag:** `ISITDTU{Congrats_You_Solved_TLS_Callback_Re01_Have_Fun_:)}`
