- Đề cho 1 file PE64

![image](https://github.com/user-attachments/assets/c02e779c-f9b3-468d-9ac4-24122c544d23)

- Pseudocode của IDA (Mình đã rename lại tên một số biến và hàm để tiện hơn cho việc phân tích)
```C++
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char *v3; // rax
  __int64 v4; // rax
  __int64 v5; // rax
  int v7; // [rsp+20h] [rbp-708h]
  int i; // [rsp+24h] [rbp-704h]
  int j; // [rsp+28h] [rbp-700h]
  int k; // [rsp+2Ch] [rbp-6FCh]
  int v11; // [rsp+30h] [rbp-6F8h]
  int v12; // [rsp+34h] [rbp-6F4h]
  int v13; // [rsp+38h] [rbp-6F0h]
  int v14; // [rsp+3Ch] [rbp-6ECh]
  int v15; // [rsp+40h] [rbp-6E8h]
  int v16; // [rsp+44h] [rbp-6E4h]
  int v17; // [rsp+48h] [rbp-6E0h]
  int v18; // [rsp+4Ch] [rbp-6DCh]
  _QWORD *v19; // [rsp+50h] [rbp-6D8h]
  int v20[20]; // [rsp+60h] [rbp-6C8h]
  int v21[20]; // [rsp+B0h] [rbp-678h]
  int v22[160]; // [rsp+100h] [rbp-628h]
  int v23[160]; // [rsp+380h] [rbp-3A8h]
  __int64 v24; // [rsp+600h] [rbp-128h]
  char *v25; // [rsp+608h] [rbp-120h]
  void *v26; // [rsp+610h] [rbp-118h]
  char v27[32]; // [rsp+618h] [rbp-110h] BYREF
  char v28[32]; // [rsp+638h] [rbp-F0h] BYREF
  char v29[32]; // [rsp+658h] [rbp-D0h] BYREF
  char v30[32]; // [rsp+678h] [rbp-B0h] BYREF
  char v31[32]; // [rsp+698h] [rbp-90h] BYREF
  char v32[32]; // [rsp+6B8h] [rbp-70h] BYREF
  char v33[32]; // [rsp+6D8h] [rbp-50h] BYREF
  char v34[32]; // [rsp+6F8h] [rbp-30h] BYREF

  sub_7FF74B263920(v29);
  sub_7FF74B2646B0(std::cout, "Enter something: ");
  sub_7FF74B264A30(std::cin, v29);
  v21[0] = 2741159;
  v21[1] = 2807211;
  v21[2] = 3698913;
  v21[3] = 3335627;
  v21[4] = 3764965;
  v21[5] = 3137471;
  v21[6] = 3335627;
  v21[7] = 1717352;
  v21[8] = 3797991;
  v21[9] = 3996147;
  v21[10] = 3137471;
  v21[11] = 2543003;
  v21[12] = 3302601;
  v21[13] = 1750378;
  v21[14] = 3137471;
  v21[15] = 2212743;
  v21[16] = 2708133;
  v21[17] = 1717352;
  v21[18] = 2212743;
  v21[19] = 2476951;
  v22[0] = 1816430;
  v22[1] = 1717352;
  v22[2] = 1783404;
  v22[3] = 3368653;
  v22[4] = 1618274;
  v22[5] = 1750378;
  v22[6] = 1684326;
  v22[7] = 1816430;
  v22[8] = 1684326;
  v22[9] = 3203523;
  v22[10] = 1651300;
  v22[11] = 1816430;
  v22[12] = 1750378;
  v22[13] = 3335627;
  v22[14] = 1684326;
  v22[15] = 1717352;
  v22[16] = 1684326;
  v22[17] = 1684326;
  v22[18] = 1585248;
  v22[19] = 1618274;
  v22[20] = 1585248;
  v22[21] = 3335627;
  v22[22] = 1684326;
  v22[23] = 1750378;
  v22[24] = 1651300;
  v22[25] = 3203523;
  v22[26] = 3236549;
  v22[27] = 3335627;
  v22[28] = 3236549;
  v22[29] = 3368653;
  v22[30] = 1849456;
  v22[31] = 1816430;
  v22[32] = 1717352;
  v22[33] = 1585248;
  v22[34] = 3368653;
  v22[35] = 1717352;
  v22[36] = 1816430;
  v22[37] = 1651300;
  v22[38] = 1684326;
  v22[39] = 1585248;
  v22[40] = 3368653;
  v22[41] = 1750378;
  v22[42] = 3203523;
  v22[43] = 3302601;
  v22[44] = 1651300;
  v22[45] = 1651300;
  v22[46] = 1717352;
  v22[47] = 1849456;
  v22[48] = 1882482;
  v22[49] = 1816430;
  v22[50] = 1816430;
  v22[51] = 1783404;
  v22[52] = 1717352;
  v22[53] = 3203523;
  v22[54] = 1684326;
  v22[55] = 3368653;
  v22[56] = 1882482;
  v22[57] = 1816430;
  v22[58] = 3203523;
  v22[59] = 3368653;
  v22[60] = 1849456;
  v22[61] = 1585248;
  v22[62] = 1750378;
  v22[63] = 1816430;
  v22[64] = 3236549;
  v22[65] = 1783404;
  v22[66] = 3236549;
  v22[67] = 3236549;
  v22[68] = 1585248;
  v22[69] = 3236549;
  v22[70] = 3335627;
  v22[71] = 1750378;
  v22[72] = 3269575;
  v22[73] = 1684326;
  v22[74] = 1684326;
  v22[75] = 1717352;
  v22[76] = 1783404;
  v22[77] = 1783404;
  v22[78] = 1882482;
  v22[79] = 3368653;
  v22[80] = 3236549;
  v22[81] = 3269575;
  v22[82] = 1717352;
  v22[83] = 3236549;
  v22[84] = 1750378;
  v22[85] = 1717352;
  v22[86] = 1849456;
  v22[87] = 3335627;
  v22[88] = 3236549;
  v22[89] = 3236549;
  v22[90] = 1816430;
  v22[91] = 3236549;
  v22[92] = 3203523;
  v22[93] = 1684326;
  v22[94] = 3335627;
  v22[95] = 1651300;
  v22[96] = 1783404;
  v22[97] = 1717352;
  v22[98] = 1618274;
  v22[99] = 3368653;
  v22[100] = 3203523;
  v22[101] = 1750378;
  v22[102] = 3335627;
  v22[103] = 1717352;
  v22[104] = 1750378;
  v22[105] = 3236549;
  v22[106] = 3302601;
  v22[107] = 1882482;
  v22[108] = 1750378;
  v22[109] = 1684326;
  v22[110] = 3269575;
  v22[111] = 1816430;
  v22[112] = 1684326;
  v22[113] = 1684326;
  v22[114] = 1585248;
  v22[115] = 1816430;
  v22[116] = 1882482;
  v22[117] = 1585248;
  v22[118] = 1651300;
  v22[119] = 3368653;
  v22[120] = 1783404;
  v22[121] = 1783404;
  v22[122] = 3302601;
  v22[123] = 3302601;
  v22[124] = 1618274;
  v22[125] = 1783404;
  v22[126] = 1816430;
  v22[127] = 1684326;
  v22[128] = 1882482;
  v22[129] = 1849456;
  v22[130] = 3203523;
  v22[131] = 3236549;
  v22[132] = 3335627;
  v22[133] = 1684326;
  v22[134] = 3203523;
  v22[135] = 1651300;
  v22[136] = 1849456;
  v22[137] = 1684326;
  v22[138] = 1849456;
  v22[139] = 1684326;
  v22[140] = 1750378;
  v22[141] = 1585248;
  v22[142] = 1618274;
  v22[143] = 3368653;
  v22[144] = 1717352;
  v22[145] = 3236549;
  v22[146] = 3368653;
  v22[147] = 3302601;
  v22[148] = 1651300;
  v22[149] = 3302601;
  v22[150] = 1882482;
  v22[151] = 1585248;
  v22[152] = 1816430;
  v22[153] = 1816430;
  v22[154] = 1849456;
  v22[155] = 1651300;
  v22[156] = 1585248;
  v22[157] = 3368653;
  v22[158] = 1618274;
  v22[159] = 1618274;
  v7 = 0;
  sub_7FF74B263860((__int64)v31, (__int64)&unk_7FF74B268489);
  while ( v7 < 400 )
  {
    if ( *(_BYTE *)iter_char(v29, 0i64) == 'E' )
    {
      v20[0] = 3236549;
      v20[1] = 3203523;
      v20[2] = 3632861;
      v20[3] = 3137471;
      v20[4] = 3302601;
      v20[5] = 3203523;
      v20[6] = 3137471;
      v20[7] = 3236549;
      v20[8] = 3467731;
      v20[9] = 3137471;
      v20[10] = 3566809;
      v20[11] = 3864043;
      v20[12] = 3203523;
      v20[13] = 1089858;
      v20[14] = 1089858;
      v20[15] = 1089858;
      v20[16] = 1089858;
      v20[17] = 1089858;
      v20[18] = 1089858;
      v20[19] = 1089858;
      v14 = 127 * v20[indices[v7]];
      v15 = (*(char *)iter_char(v29, indices[v7]) + v14) >> 22;
      std::string::operator+=(v31, (unsigned __int8)v15);
    }
    else
    {
      v16 = 127 * v21[indices[v7]];
      v17 = (*(char *)iter_char(v29, indices[v7]) + v16) >> 22;
      std::string::operator+=(v31, (unsigned __int8)v17);
    }
    v7 += 21;
  }
  v19 = debug_check();
  sub_7FF74B263860((__int64)v30, (__int64)"Correct?");
  if ( (unsigned __int8)sub_7FF74B264D40(v19, "1") )
  {
    v23[0] = 1585248;
    v23[1] = 1882482;
    v23[2] = 3302601;
    v23[3] = 1618274;
    v23[4] = 1750378;
    v23[5] = 3236549;
    v23[6] = 1882482;
    v23[7] = 3368653;
    v23[8] = 1651300;
    v23[9] = 1717352;
    v23[10] = 1783404;
    v23[11] = 1717352;
    v23[12] = 3269575;
    v23[13] = 3368653;
    v23[14] = 1585248;
    v23[15] = 1651300;
    v23[16] = 1651300;
    v23[17] = 1849456;
    v23[18] = 1717352;
    v23[19] = 3203523;
    v23[20] = 1816430;
    v23[21] = 3335627;
    v23[22] = 1618274;
    v23[23] = 3203523;
    v23[24] = 3236549;
    v23[25] = 3302601;
    v23[26] = 3236549;
    v23[27] = 1618274;
    v23[28] = 3368653;
    v23[29] = 3302601;
    v23[30] = 1618274;
    v23[31] = 1816430;
    v23[32] = 3335627;
    v23[33] = 1816430;
    v23[34] = 3269575;
    v23[35] = 1750378;
    v23[36] = 1585248;
    v23[37] = 3335627;
    v23[38] = 3203523;
    v23[39] = 1816430;
    v23[40] = 1849456;
    v23[41] = 1717352;
    v23[42] = 3269575;
    v23[43] = 1684326;
    v23[44] = 1684326;
    v23[45] = 3368653;
    v23[46] = 1717352;
    v23[47] = 3269575;
    v23[48] = 1882482;
    v23[49] = 3203523;
    v23[50] = 3368653;
    v23[51] = 1783404;
    v23[52] = 3269575;
    v23[53] = 1618274;
    v23[54] = 1585248;
    v23[55] = 1849456;
    v23[56] = 1849456;
    v23[57] = 1717352;
    v23[58] = 3368653;
    v23[59] = 1717352;
    v23[60] = 1684326;
    v23[61] = 1651300;
    v23[62] = 3236549;
    v23[63] = 1618274;
    v23[64] = 1618274;
    v23[65] = 3236549;
    v23[66] = 1849456;
    v23[67] = 1882482;
    v23[68] = 1618274;
    v23[69] = 1585248;
    v23[70] = 3302601;
    v23[71] = 1651300;
    v23[72] = 1882482;
    v23[73] = 1717352;
    v23[74] = 1750378;
    v23[75] = 1783404;
    v23[76] = 1651300;
    v23[77] = 1849456;
    v23[78] = 3302601;
    v23[79] = 1618274;
    v23[80] = 1816430;
    v23[81] = 1816430;
    v23[82] = 1651300;
    v23[83] = 1651300;
    v23[84] = 3236549;
    v23[85] = 3203523;
    v23[86] = 1717352;
    v23[87] = 1618274;
    v23[88] = 1816430;
    v23[89] = 1651300;
    v23[90] = 3368653;
    v23[91] = 3335627;
    v23[92] = 1783404;
    v23[93] = 3302601;
    v23[94] = 3269575;
    v23[95] = 1849456;
    v23[96] = 1618274;
    v23[97] = 3236549;
    v23[98] = 3335627;
    v23[99] = 3335627;
    v23[100] = 3335627;
    v23[101] = 3335627;
    v23[102] = 1849456;
    v23[103] = 1849456;
    v23[104] = 1618274;
    v23[105] = 1651300;
    v23[106] = 1816430;
    v23[107] = 3236549;
    v23[108] = 3236549;
    v23[109] = 3368653;
    v23[110] = 3203523;
    v23[111] = 3368653;
    v23[112] = 3368653;
    v23[113] = 3236549;
    v23[114] = 3335627;
    v23[115] = 3302601;
    v23[116] = 3335627;
    v23[117] = 3203523;
    v23[118] = 1618274;
    v23[119] = 1783404;
    v23[120] = 1618274;
    v23[121] = 3302601;
    v23[122] = 1849456;
    v23[123] = 1651300;
    v23[124] = 1750378;
    v23[125] = 1651300;
    v23[126] = 1684326;
    v23[127] = 1585248;
    v23[128] = 3269575;
    v23[129] = 3236549;
    v23[130] = 1618274;
    v23[131] = 3269575;
    v23[132] = 3203523;
    v23[133] = 1585248;
    v23[134] = 1585248;
    v23[135] = 1849456;
    v23[136] = 1651300;
    v23[137] = 1651300;
    v23[138] = 1717352;
    v23[139] = 1783404;
    v23[140] = 1816430;
    v23[141] = 1750378;
    v23[142] = 3203523;
    v23[143] = 1816430;
    v23[144] = 1618274;
    v23[145] = 1750378;
    v23[146] = 1849456;
    v23[147] = 3236549;
    v23[148] = 1585248;
    v23[149] = 3335627;
    v23[150] = 3335627;
    v23[151] = 1684326;
    v23[152] = 3368653;
    v23[153] = 3302601;
    v23[154] = 1684326;
    v23[155] = 3335627;
    v23[156] = 3335627;
    v23[157] = 1585248;
    v23[158] = 1849456;
    v23[159] = 3269575;
    for ( i = 0; i < 160; ++i )
      v22[i] = v23[i];
    v24 = sub_7FF74B263620((int)v30, (__int64)v27, 0, 7);
    sub_7FF74B2637E0(v30, v24);
    sub_7FF74B2637B0(v27);
    v19 = sub_7FF74B261F00();
  }
  v11 = 0;
  v13 = 1;
  for ( j = 0; j <= 4; ++j )
  {
    sub_7FF74B263860((__int64)v32, (__int64)&unk_7FF74B26848A);
    std::shared_ptr<__ExceptionPtr>::operator=(v34, &v19[4 * j]);
    v12 = 0;
    v25 = v28;
    v26 = (void *)sub_7FF74B263620((int)v31, (__int64)v28, 4 * j, 4);
    sub_7FF74B261DB0(v33, v26);
    for ( k = v11; k < v11 + 32; ++k )
    {
      v18 = 127 * v22[k];
      v3 = (char *)iter_char(v34, v12);
      std::string::operator+=(v32, (unsigned __int8)((*v3 + v18) >> 22));
      ++v12;
    }
    v11 += 32;
    if ( sub_7FF74B264D70((__int64)v33, (__int64)v32) )
      v13 = 0;
    sub_7FF74B2637B0(v33);
    sub_7FF74B2637B0(v34);
    sub_7FF74B2637B0(v32);
  }
  if ( !v13 )
  {
    v5 = sub_7FF74B2646B0(std::cout, "Something unto death?");
    std::ostream::operator<<(v5, sub_7FF74B264E00);
    ExitProcess(0xFFFFFFFF);
  }
  v4 = sub_7FF74B264DB0(std::cout, v30);
  std::ostream::operator<<(v4, sub_7FF74B264E00);
  sub_7FF74B2637B0(v30);
  sub_7FF74B2637B0(v31);
  sub_7FF74B2637B0(v29);
  return 0;
}
```
- Nhìn tổng quan thì chương trình có vẻ sẽ thực hiện các phép tính toán lên input của chúng ta thông qua 1 số các array khác nhau (đây có thể là các hash table), và sau khi thực hiện hết các phép toán thì `sub_7FF74B264D70` sẽ có nhiệm vụ kiểm tra rồi set flag tương ứng để in ra string `Correct` hoặc `Something unto death?`
- Trước tiên hãy xem input của chúng ta được xử lí như thế nào (để kiểm chứng chúng ta có thể debug)
  + Input được xử lí trong vòng `while(v7<400)` sẽ được gán vào `v31`
  + Từ vòng `while(v7<400)` ta có thể suy ra được input sẽ có độ dài là 20 kí tự
  + Có thể thấy tùy thuộc vào kí tự đầu tiên của input mà chương trình có thể chạy qua 1 trong 2 luồng
  + Nếu kí tự đầu tiên là `E` thì input sẽ được xử lí thông qua `v20` và khi ta nhập 19 kí tự còn lại random thì sẽ nhận được chuỗi `ban_da_bi_lua!!`
    
    ![image](https://github.com/user-attachments/assets/f9a990be-07ef-49b2-8eb3-6278f0d60fcf)


  + Nếu không thì sẽ được xử lí thông qua `v21` và các chuỗi được gen ra từ luồng này cũng có một điểm chung với luồng trên là không phụ thuộc quá nhiều vào input. Vậy ta có thể viết script để brute ra những output có thể được gen ra ở `v31` theo từng index
    
```python
idx = int(input("Enter index:"))
v20 = [
    3236549, 3203523, 3632861, 3137471, 3302601, 3203523, 3137471, 3236549, 
    3467731, 3137471, 3566809, 3864043, 3203523, 1089858, 1089858, 1089858, 
    1089858, 1089858, 1089858, 1089858
]
x = [0] * 20 

indices = [
    0x0, 0x27, 0xA, 0x18, 0x15, 0x8, 0x1E, 0x26, 0xF, 0x5, 0x8, 0xF, 0xA, 0x18, 0x7, 0x10,
    0x14, 0x11, 0x8, 0x5, 0x18, 0x1, 0x1D, 0xF, 0x9, 0x19, 0x28, 0x16, 0x26, 0x2, 0x5, 0x1B,
    0xE, 0x12, 0x26, 0x26, 0x11, 0x6, 0x20, 0x4, 0x1A, 0x17, 0x2, 0xC, 0x11, 0x1, 0x14, 0xC,
    0x25, 0x1A, 0x25, 0x1C, 0x3, 0xE, 0x4, 0x21, 0xC, 0x18, 0x9, 0x24, 0x17, 0x1A, 0x20,
    0x3, 0x27, 0x8, 0xE, 0x11, 0x18, 0x4, 0x18, 0x11, 0x1E, 0x4, 0x10, 0x5, 0xC, 0xD, 0xD,
    0x8, 0x3, 0xF, 0xE, 0x17, 0x4, 0x17, 0x1E, 0x7, 0x1C, 0x15, 0x23, 0x0, 0xD, 0x1E, 0x11,
    0x11, 0x25, 0x27, 0xA, 0x20, 0x10, 0x21, 0x21, 0xC, 0x0, 0x5, 0x1A, 0x18, 0x3, 0x1C,
    0xC, 0x21, 0x1D, 0x28, 0x11, 0x10, 0x1C, 0x28, 0x6, 0x0, 0x20, 0x22, 0x15, 0x1D, 0x26,
    0x9, 0x6, 0x0, 0x23, 0x6, 0x1D, 0x2, 0x1, 0x2, 0x28, 0x9, 0x1A, 0x0, 0x10, 0x16, 0x8,
    0xC, 0x1C, 0x1, 0x1A, 0x27, 0x2, 0x7, 0x3, 0x19, 0x27, 0x1B, 0x15, 0x11, 0x1F, 0xC, 0x26,
    0x7, 0x16, 0x1A, 0x5, 0x3, 0x24, 0x17, 0x28, 0x6, 0x7, 0x20, 0x8, 0xD, 0x12, 0x10, 0x21,
    0x11, 0xC, 0x15, 0x23, 0x1A, 0xA, 0x21, 0x13, 0xC, 0x11, 0x9, 0x1B, 0x13, 0xB, 0x1E, 0x15,
    0x9, 0x2, 0x1F, 0xD, 0x3, 0x15, 0x1C, 0x25, 0x28, 0x16, 0x4, 0x17, 0x26, 0x2, 0x15, 0x12,
    0x1E, 0x7, 0xA, 0x1D, 0x9, 0xA, 0xA, 0x15, 0x1E, 0xA, 0x4, 0x2, 0xE, 0x1E, 0x4, 0x1D,
    0x1B, 0x15, 0x18, 0x20, 0x21, 0x1B, 0xB, 0xD, 0x1C, 0x3, 0xB, 0x19, 0x13, 0x9, 0x15,
    0xA, 0x1D, 0x1F, 0xC, 0x10, 0x20, 0x1D, 0x27, 0x26, 0x28, 0x12, 0x1F, 0x27, 0x1,
    0x23, 0x0, 0xC, 0x25, 0x0, 0x5, 0x2, 0x1, 0x1D, 0xD, 0x26, 0x25, 0x15, 0x17, 0x16, 0x8,
    0x5, 0x24, 0x4, 0x15, 0x16, 0x26, 0x24, 0xD, 0x11, 0x5, 0x1D, 0x1, 0x9, 0x19, 0x16, 0x17,
    0x7, 0xB, 0x16, 0x3, 0x1B, 0xE, 0x12, 0x27, 0x5, 0x25, 0x21, 0x1D, 0xE, 0x1D, 0xA,
    0x1E, 0x25, 0x28, 0x1D, 0x13, 0x1F, 0x25, 0x14, 0x12, 0xE, 0x18, 0x19, 0x25, 0x4,
    0x11, 0x1E, 0x4, 0x27, 0xF, 0x28, 0x5, 0x22, 0x19, 0x9, 0x28, 0x28, 0xD, 0x9, 0x3, 0x15,
    0x24, 0x9, 0xC, 0x5, 0xA, 0x16, 0x14, 0x6, 0x4, 0x10, 0x27, 0x22, 0x1D, 0x14, 0x12, 0x13,
    0x5, 0x17, 0x16, 0x9, 0x24, 0x1E, 0x1E, 0x6, 0x25, 0x0, 0x2, 0xF, 0xF, 0xA, 0x11, 0x6,
    0x24, 0x2, 0x22, 0xB, 0x2, 0x27, 0xB, 0x1C, 0x16, 0x25, 0x1E, 0x13, 0x18, 0x5, 0xE,
    0x1B, 0xD, 0xC, 0x4, 0x12, 0x28, 0x25, 0x5, 0xF, 0x1C, 0x4, 0xF, 0xB, 0x19, 0x8, 0x23,
    0x20, 0xC, 0x1, 0x12, 0x6, 0x7, 0x8, 0x28, 0x23, 0x13
]

v21 = [
    2741159, 2807211, 3698913, 3335627, 3764965, 3137471, 3335627, 
    1717352, 3797991, 3996147, 3137471, 2543003, 3302601, 1750378, 
    3137471, 2212743, 2708133, 1717352, 2212743, 2476951
]

v7 = 0
i = 0 
v31 = ''
output = []
for test in range(0x20,0x7f):
    x = [test]*20
    v7 = 0
    i = 0 
    v31 = ''
    while(v7<400):

        v16 = 127 *v21[indices[v7]]
        v17 = int(str((x[i] + v16) >> 22))
        v31 += chr(v17)
        i += 1
        v7 += 21
    print('')
    output.append(v31[idx])
already_printed = set(output)
for i in already_printed:
    if i in already_printed:
        print(i,end =' ')
```
```
x0 S R
x1 T U
x2 o p
x3 d e
x4 q r
x5 _ ^
x6 d e
x7 4 3
x8 s r
x9 y x
x10 ^ _
x11 M
x12 c d
x13 4 5
x14 _ ^
x15 C
x16 R Q
x17 4 3
x18 C
x19 K
=>"SUper_e4sy_Md5_CR4CK" or "SUper_e4sy_Md4_CR4CK" ?
```
- Đến đây tuy là chúng ta đã có flag nhưng mà để thực sự hiểu được hết bài này thì nên tìm thêm cả input, bên dưới là script tìm input(với key là `SUper_e4sy_Md5_CR4CK`)


```python
from string import printable
testcase = printable
indices = [
    0x0, 0x27, 0xA, 0x18, 0x15, 0x8, 0x1E, 0x26, 0xF, 0x5, 0x8, 0xF, 0xA, 0x18, 0x7, 0x10,
    0x14, 0x11, 0x8, 0x5, 0x18, 0x1, 0x1D, 0xF, 0x9, 0x19, 0x28, 0x16, 0x26, 0x2, 0x5, 0x1B,
    0xE, 0x12, 0x26, 0x26, 0x11, 0x6, 0x20, 0x4, 0x1A, 0x17, 0x2, 0xC, 0x11, 0x1, 0x14, 0xC,
    0x25, 0x1A, 0x25, 0x1C, 0x3, 0xE, 0x4, 0x21, 0xC, 0x18, 0x9, 0x24, 0x17, 0x1A, 0x20,
    0x3, 0x27, 0x8, 0xE, 0x11, 0x18, 0x4, 0x18, 0x11, 0x1E, 0x4, 0x10, 0x5, 0xC, 0xD, 0xD,
    0x8, 0x3, 0xF, 0xE, 0x17, 0x4, 0x17, 0x1E, 0x7, 0x1C, 0x15, 0x23, 0x0, 0xD, 0x1E, 0x11,
    0x11, 0x25, 0x27, 0xA, 0x20, 0x10, 0x21, 0x21, 0xC, 0x0, 0x5, 0x1A, 0x18, 0x3, 0x1C,
    0xC, 0x21, 0x1D, 0x28, 0x11, 0x10, 0x1C, 0x28, 0x6, 0x0, 0x20, 0x22, 0x15, 0x1D, 0x26,
    0x9, 0x6, 0x0, 0x23, 0x6, 0x1D, 0x2, 0x1, 0x2, 0x28, 0x9, 0x1A, 0x0, 0x10, 0x16, 0x8,
    0xC, 0x1C, 0x1, 0x1A, 0x27, 0x2, 0x7, 0x3, 0x19, 0x27, 0x1B, 0x15, 0x11, 0x1F, 0xC, 0x26,
    0x7, 0x16, 0x1A, 0x5, 0x3, 0x24, 0x17, 0x28, 0x6, 0x7, 0x20, 0x8, 0xD, 0x12, 0x10, 0x21,
    0x11, 0xC, 0x15, 0x23, 0x1A, 0xA, 0x21, 0x13, 0xC, 0x11, 0x9, 0x1B, 0x13, 0xB, 0x1E, 0x15,
    0x9, 0x2, 0x1F, 0xD, 0x3, 0x15, 0x1C, 0x25, 0x28, 0x16, 0x4, 0x17, 0x26, 0x2, 0x15, 0x12,
    0x1E, 0x7, 0xA, 0x1D, 0x9, 0xA, 0xA, 0x15, 0x1E, 0xA, 0x4, 0x2, 0xE, 0x1E, 0x4, 0x1D,
    0x1B, 0x15, 0x18, 0x20, 0x21, 0x1B, 0xB, 0xD, 0x1C, 0x3, 0xB, 0x19, 0x13, 0x9, 0x15,
    0xA, 0x1D, 0x1F, 0xC, 0x10, 0x20, 0x1D, 0x27, 0x26, 0x28, 0x12, 0x1F, 0x27, 0x1,
    0x23, 0x0, 0xC, 0x25, 0x0, 0x5, 0x2, 0x1, 0x1D, 0xD, 0x26, 0x25, 0x15, 0x17, 0x16, 0x8,
    0x5, 0x24, 0x4, 0x15, 0x16, 0x26, 0x24, 0xD, 0x11, 0x5, 0x1D, 0x1, 0x9, 0x19, 0x16, 0x17,
    0x7, 0xB, 0x16, 0x3, 0x1B, 0xE, 0x12, 0x27, 0x5, 0x25, 0x21, 0x1D, 0xE, 0x1D, 0xA,
    0x1E, 0x25, 0x28, 0x1D, 0x13, 0x1F, 0x25, 0x14, 0x12, 0xE, 0x18, 0x19, 0x25, 0x4,
    0x11, 0x1E, 0x4, 0x27, 0xF, 0x28, 0x5, 0x22, 0x19, 0x9, 0x28, 0x28, 0xD, 0x9, 0x3, 0x15,
    0x24, 0x9, 0xC, 0x5, 0xA, 0x16, 0x14, 0x6, 0x4, 0x10, 0x27, 0x22, 0x1D, 0x14, 0x12, 0x13,
    0x5, 0x17, 0x16, 0x9, 0x24, 0x1E, 0x1E, 0x6, 0x25, 0x0, 0x2, 0xF, 0xF, 0xA, 0x11, 0x6,
    0x24, 0x2, 0x22, 0xB, 0x2, 0x27, 0xB, 0x1C, 0x16, 0x25, 0x1E, 0x13, 0x18, 0x5, 0xE,
    0x1B, 0xD, 0xC, 0x4, 0x12, 0x28, 0x25, 0x5, 0xF, 0x1C, 0x4, 0xF, 0xB, 0x19, 0x8, 0x23,
    0x20, 0xC, 0x1, 0x12, 0x6, 0x7, 0x8, 0x28, 0x23, 0x13
]
v21 = [
    2741159, 2807211, 3698913, 3335627, 3764965, 3137471, 3335627, 1717352, 3797991, 
    3996147, 3137471, 2543003, 3302601, 1750378, 3137471, 2212743, 2708133, 1717352, 
    2212743, 2476951
]
key = "SUper_e4sy_Md5_CR4CK" #"SUper_e4sy_Md4_CR4CK" cai nay de test xem key nao dung
v7 = 0
i = 0 
v31 = ['']*20
ii = 0
j = 0
while(v7<400):
    v16 = 127 *v21[indices[v7]]
    v17 = ((ord(testcase[i]) + v16) >> 22)
    v31.insert(ii,v17)
    if(v31[ii] == ord(key[j])):
        print(testcase[i],end='')
        ii += 1
        v7 += 21
        j += 1
        i = 0
    else:
        i+=1
        v31.remove(v31[j])
        continue
```
- Output của 2 key
    + `SUper_e4sy_Md5_CR4CK`
  
        ![image](https://github.com/user-attachments/assets/3d5e456f-b4f5-409a-a76e-7a41c77e5793)

    + `SUper_e4sy_Md4_CR4CK`
 
        ![image](https://github.com/user-attachments/assets/e6a472fc-9bfd-4390-8ccf-d6776bea972c)

- Vậy key đúng là `SUper_e4sy_Md5_CR4CK`

**Flag:** `KMACTF{SUper_e4sy_Md5_CR4CK}`

Also easter egg, nhập 20 chữ `x` làm input cũng làm cho `v31` gen ra key đúng 🐧
